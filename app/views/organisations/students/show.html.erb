<div>
  <section class="bg-gray-50">
    <div class="max-w-7xl mx-auto p-6">
      <div class="mt-4">
        <a class="bg-gray-200 px-3 py-1 text-gray-600 rounded-xl text-sm hover:text-primary-500 hover:bg-primary-50 focus:outline-none focus:text-primary-500 focus:bg-primary-50 focus:ring-1 focus:ring-focusColor-500" href="<%= students_organisation_cohort_path(@presenter.organisation, @presenter.cohort) %>"><%= t('shared.back_link') %></a>
      </div>
      <div class="mt-5 flex items-center">
        <div class="w-24">
          <div data-re-component="Avatar" data-re-json="<%= { name: @presenter.student.name }.to_json %>"></div>
        </div>
        <h1 class="text-3xl font-bold pl-4"><%= @presenter.student.name %></h1>
      </div>
      <div class="w-full lg:w-3/4 xl:w-1/2 mt-5">
        <div data-re-component="LevelProgressBar" data-re-json="<%= @presenter.level_progress_bar_props.to_json %>"></div>
      </div>
    </div>
  </section>
  <section class="bg-white">
    <div class="max-w-7xl mx-auto p-6">
      <h2 class="text-xl font-semibold mt-4">Targets Overview</h2>
      <div aria-label="target-completion-status" class="p-4 flex flex-col border rounded-lg w-1/2 md:w-1/4 mt-3">
        <%= render 'donut_chart', color: 'purple', percentage: @presenter.target_completion_percentage %>
        <p class="text-sm font-semibold text-center mt-3">Total Targets Completed</p>
        <p class="text-sm text-gray-600 font-semibold text-center mt-1"><%= @presenter.targets_completed %>/<%= @presenter.total_targets %> Targets</p>
      </div>
      <% if @presenter.average_grades.any? %>
        <h2 class="text-xl font-semibold mt-5">Average Grades</h2>
        <div class="flex flex-wrap gap-3">
          <% @presenter.average_grades.each do |average_grade| %>
            <div class="flex p-4 mt-3 border rounded-lg items-center">
              <div class="flex flex-col items-center">
                <%= render 'pie_chart', percentage: average_grade[:percentage]  %>
                <span class="pt-2 text-lg font-semibold"><%= average_grade[:average_grade].to_s.sub(/\.?0+$/, '') %>/<%= average_grade[:max_grade] %></span>
              </div>
              <p class="text-sm font-semibold pl-5 pt-3 pb-4"><%= average_grade[:name] %></p>
            </div>
          <% end %>
          <div class="flex p-4 mt-3 border rounded-lg items-center">
            <div class="flex flex-col items-center">
              <svg class="student-overlay__pie-chart student-overlay__pie-chart--pass" viewBox="0 0 32 32">
                <circle class="student-overlay__pie-chart-circle student-overlay__pie-chart-circle--pass" cx="16" cy="16" r="16" stroke-dasharray="50, 100"></circle>
              </svg>
              <span class="pt-2 text-lg font-semibold">2/4</span>
            </div>
            <p class="text-sm font-semibold pl-5 pt-3 pb-4">Quality</p>
          </div>
        </div>
      <% end %>
      <% if @presenter.coach_notes.exists? %>
        <h2 class="text-xl font-semibold mt-5">Notes</h2>
        <% @presenter.coach_notes.each do |coach_note| %>
          <div class="mt-4 p-6 bg-white items-center border border-transparent rounded-lg shadow">
            <p class="inline-block text-xs font-semibold leading-tight bg-gray-300 text-gray-800 mt-px px-1 py-px rounded" title="<%= coach_note.created_at.iso8601 %>"><%= coach_note.created_at.strftime("%B %-d, %Y") %></p>
            <p class="mt-2 convert-markdown" data-json-props="<%= {profile: 'permissive', markdown: coach_note.note}.to_json %>"><%= coach_note.note %></p>
          </div>
        <% end %>
      <% end %>
      <% if @presenter.submissions_pending_review.exists? %>
        <h2 class="text-xl font-semibold mt-4">Submissions waiting for review</h2>
        <% @presenter.submissions_pending_review.each do |submission| %>
          <%= render 'submission', submission: submission %>
        <% end %>
      <% end %>
      <% if @presenter.reviewed_submissions.exists? %>
        <h2 class="text-xl font-semibold mt-4">Reviewed submissions</h2>
        <a class="mt-4 p-6 flex bg-white items-center border border-transparent rounded-lg shadow font-semibold hover:bg-primary-50 hover:text-primary-500 hover:border-primary-500 cursor-pointer" href="<%= submissions_org_student_path(@presenter.student) %>">
          <i class="if i-clipboard-check-regular if-fw"></i>
          <span class="pl-2">View previously reviewed submissions</span>
        </a>
      <% end %>
    </div>
  </section>
</div>
